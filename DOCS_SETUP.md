# GitHub Pages Documentation Setup

This document provides instructions for setting up and deploying Parsnip documentation to GitHub Pages.

## What's Included

The documentation system includes:

1. **User Guide** - Sphinx-based documentation from `parsnip-docs/`
2. **API Documentation** - Dokka-generated Kotlin API docs from `parsnip/`
3. **Landing Page** - Custom HTML page that provides navigation to both docs

## GitHub Actions Workflow

The `.github/workflows/docs.yml` workflow:

- ✅ **Builds** Sphinx documentation with Read the Docs theme
- ✅ **Generates** Dokka API documentation for Kotlin code
- ✅ **Combines** both into a unified documentation site
- ✅ **Deploys** to GitHub Pages on main branch pushes
- ✅ **Validates** builds on pull requests without deploying

## Required Repository Configuration

To enable GitHub Pages deployment, the repository owner must:

### 1. Enable GitHub Pages

1. Go to repository **Settings** → **Pages**
2. Under **Source**, select **GitHub Actions**
3. This allows the workflow to deploy to GitHub Pages

### 2. Verify Workflow Permissions

1. Go to **Settings** → **Actions** → **General**
2. Under **Workflow permissions**, ensure:
   - **Read and write permissions** is selected, OR
   - **Read repository contents and packages permissions** with **Allow GitHub Actions to create and approve pull requests**

## Testing the Documentation Locally

### Prerequisites

- Java 17+ (for Maven/Dokka)
- Python 3.x with pip
- Maven

### Build Sphinx Documentation

```bash
# Install Sphinx
pip install sphinx sphinx-rtd-theme

# Build the user guide
cd parsnip-docs
mvn clean compile

# Output will be in: target/site/
```

### Build Dokka API Documentation  

```bash
# Build API documentation
cd parsnip
mvn clean compile dokka:dokka -Prelease

# Output will be in: target/dokka/
```

### Build Complete Documentation Site

```bash
# From repository root
mkdir -p docs-output/user-guide
mkdir -p docs-output/api

# Copy built documentation
cp -r parsnip-docs/target/site/* docs-output/user-guide/
cp -r parsnip/target/dokka/* docs-output/api/

# The docs-output/ directory will contain the complete site
# (This directory is gitignored and only used for local testing)
```

## Documentation Structure

Once deployed, the documentation will be available at:

- `https://aplpolaris.github.io/parsnip/` - Main landing page
- `https://aplpolaris.github.io/parsnip/user-guide/` - Sphinx user guide
- `https://aplpolaris.github.io/parsnip/api/` - Dokka API reference

## Customization

### Sphinx Configuration

The Sphinx configuration in `parsnip-docs/src/main/site/rst/conf.py` includes:

- **Theme**: Read the Docs theme (`sphinx_rtd_theme`)
- **Branding**: Custom colors matching the project theme
- **Version**: Set to current release version (1.1.2)

### Landing Page

The main landing page is generated by the workflow and includes:

- Project overview and description
- Navigation cards to both documentation sections  
- Responsive design with project branding
- Links to GitHub repository

### Adding New Documentation

To add new pages to the user guide:

1. Create `.rst` files in `parsnip-docs/src/main/site/rst/`
2. Add them to the `toctree` in `index.rst`
3. The workflow will automatically include them in the next build

## Troubleshooting

### Workflow Not Running

- Ensure GitHub Pages is enabled with "GitHub Actions" as source
- Check repository workflow permissions
- Verify the workflow file syntax is correct

### Documentation Not Building

- Check Maven build succeeds locally
- Ensure all dependencies (Sphinx, Dokka) are properly configured
- Review workflow logs in Actions tab

### Documentation Not Updating

- Ensure changes are pushed to the `main` branch
- Check that the workflow completed successfully  
- GitHub Pages may take a few minutes to reflect changes

## Issues Addressed

This setup addresses GitHub issues:

- **#4**: Set up CI so that docs are automatically published to GitHub Pages
- **#5**: Create GitHub Pages site for parsnip based on the user guide  
- **#10**: Build Dokka automatically for GitHub Pages

The implementation provides a complete documentation deployment solution with both user and API documentation.